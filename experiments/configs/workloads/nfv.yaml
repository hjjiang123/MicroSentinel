workload: nfv_service_chain
chain:
  host: "211.0.0.101"
  stages:
    - name: "firewall"
      binary: "python3 experiments/workloads/nfv/firewall.py"
      policy_file: "experiments/workloads/nfv/policies/firewall.yaml"
      truth_log: "truth/firewall_decisions.json"
      truth_limit: 4096
    - name: "nat"
      binary: "python3 experiments/workloads/nfv/nat.py"
      truth_log: "truth/nat_translations.json"
      truth_limit: 4096
    - name: "rate_limiter"
      binary: "python3 experiments/workloads/nfv/rate_limiter.py"
      target_pps: 2_000_000
      truth_log: "truth/rate_limiter_events.json"
      truth_limit: 4096
    - name: "logger"
      binary: "python3 experiments/workloads/nfv/logger.py"
      truth_log: "truth/logger_snapshots.json"
      truth_limit: 1024
  wiring:
    ingress_if: "veth_ing"
    egress_if: "veth_eg"
traffic_generator:
  binary: "python3 experiments/workloads/nfv/traffic_gen.py"
  packet_size_bytes: [64, 256, 1500]
  mix_ratio: [0.5, 0.3, 0.2]
  rate_mode: "pps"
  rate_values: [1_000_000, 2_000_000, 4_000_000]
  dst_ports: [80, 443, 8443]
  tenants: ["tenant-a", "tenant-b", "tenant-c"]
  truth_log: "truth/traffic_emit.json"
  truth_limit: 8192
  target_host: "211.0.0.101"
  remote:
    host: "211.0.0.102"
    workdir: "~/MicroSentinel"
    metrics_dir: "~/MicroSentinel/artifacts/remote"
topology:
  namespaces:
    - name: "ms_ingress"
    - name: "ms_chain"
    - name: "ms_egress"
  veth_pairs:
    - { left: "ms_ingress", ifname: "veth_ing", peer: "chain_ing" }
    - { left: "ms_chain", ifname: "chain_eg", peer: "veth_eg" }
telemetry:
  pktgen_stats: true
  perf_stat: true
